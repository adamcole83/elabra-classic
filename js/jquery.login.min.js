(function(e){e.fn.auth=function(t){var n=e(this),r=e.extend({},e.fn.auth.defaults,t);var i=function(){if(e(r.usernameID).val()==="")e(r.usernameID).focus();else{e(r.passwordID).focus().val("")}};var s=function(t){e(r.dialogBox).html("<"+r.errorElement+' class="'+r.errorClass+'">'+t+"</"+r.errorElement+">").show();n.addClass("errChange");notify(systemTitle,{body:username+" failed authentication.",tag:"authFail."+username});i()};var o=function(t){var n=e(t).position().left;e(t).addClass("errChange").animate({left:"-=10"},50,"easeOutBounce").animate({left:"+=20"},50,"easeOutBounce").animate({left:"-=10"},50,"easeOutBounce").animate({left:"+=20"},50,"easeOutBounce").animate({left:0},50,"easeOutBounce");i()};e(r.usernameID).focus();n.submit(function(){var t=n.find(r.usernameID).val(),i=n.find(r.passwordID).val();if(t===""||i===""){s(r.errorText);if(r.wiggleDialog===true){o(r.dialogBox)}if(r.wiggleForm===true){o(n)}}else{e(r.dialogBox).hide();var u=n.serializeArray();if(r.bypass!==false){u.push({name:"bypass",value:r.bypass})}e.ajax({type:"POST",url:r.xhrLDAP,dataType:"json",data:e.param(u),success:function(i){if(i===null){s("Username/password combination failed.");if(r.wiggleDialog===true){o(r.dialogBox)}if(r.wiggleForm===true){o(n)}}else if(typeof i.error!=="undefined"){s("Error: "+i.error)}else{n.fadeOut(500,function(){var s=i.first_name,o=i.last_name;n.empty();e("<"+r.welcomeElement+' class="'+r.welcomeClass+'">'+"Welcome "+s+" "+o+"<span>Redirecting...<span>"+"</"+r.welcomeElement+">").appendTo(n);n.fadeIn(500);notify(systemTitle,{body:t+" has logged in",tag:"authSuccess."+t});setTimeout(function(){},1e3)}).removeClass("errChange")}}})}return false});n.find(r.forgotAnchor).bind({click:function(){var t=r.useLDAP===true?r.passwdLdap:r.passwdDb;e(r.bubbleDrop).stop(true).html("<span>"+t+"</span>").slideDown(400,"easeOutElastic").delay(5e3).slideUp(400,"easeInElastic")}})};e.fn.auth.defaults={ldap:true,xhrLDAP:"/admin/includes/xhr/login.php",redirect:"index.php",usernameID:"#username",passwordID:"#password",useLDAP:true,bypass:false,dialogBox:"#dialog",dialogTop:40,dialogLeft:"+=0",errorClass:"error",errorElement:"p",errorText:"Authentication required.",welcomeElement:"p",welcomeClass:"welcome",boxReturnLeft:0,wiggleDialog:true,wiggleForm:true,forgotAnchor:"#retrievepwd",bubbleDrop:"#bubbledrop",passwdLdap:'Please contact the University of Missouri <a href="http://www.umsystem.edu/ums/departments/is/helpdesks.shtml">help desk</a> for password retrieval.',passwdDb:'Please contact the <a href="mailto:jenkinsac@health.missouri.edu">Office of Communications</a> for password retrieval.'}})(jQuery)