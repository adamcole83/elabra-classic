var root="/var/www/html/";var apps=root+"admin/applications/";var type="";function Browse(b,a){type=b;$.ajax({url:"layouts/browser.php?a="+type,cache:false,success:function(c){$("#content").append(c);if(type=="extract"){PageLayout_Extract(a)}if(type=="open"){PageLayout_Open()}}})}function PageLayout_Extract(a){PageLayout();$("#filebrowser h1.title").text("Deploy: "+$("#title-"+a).text());$("#d-extract").click(function(){DeployApplication(a)})}function PageLayout_Open(){PageLayout();$("#filebrowser h1.title").text("Open");$("#d-open").click(function(){var a=GetLocation();$("input#directory").val(a);CloseWindow("#filebrowser")})}function PageLayout(){var a=GetLocation();ShowBrowser(a);OpenWindow("#filebrowser");$("#d-cancel").click(function(){CloseWindow("#filebrowser")});$("#d-new-folder").click(function(){OpenWindow("#folder-window");$("input#folder").focus();$(document).keypress(function(b){switch(b.which){case 0:CloseNewFolder();break;case 13:Process_NewFolder();break}});$("#f-cancel").click(function(){CloseNewFolder()});$("#f-create").click(function(){Process_NewFolder()})});$("select#location").change(function(){var c=$("select#location option:selected").val();var d="";var b=false;$(this).children("option").each(function(){if(!b){d+=$(this).val()}if(b){$(this).remove()}if($(this).val()==c){b=true}});ShowBrowser(d)})}function ShowBrowser(a){if(!a){a=""}a=a.replace(/\/var\/www\/html\/medicine\.missouri\.edu\/(.*)/,"$1");$("#filebrowser .browser").html("");$.ajax({url:"includes/files.php?dir="+a+"&type="+type,cache:false,success:function(b){$("#filebrowser .browser").html(b);NavigateBrowser()}})}function NavigateBrowser(){$(".view div").each(function(){$(this).click(function(){$(this).parent().children("div").each(function(){$(this).children("span").removeClass("selected")});$(this).children("span").addClass("selected")});$(this).dblclick(function(){var a=$(this).children("span").text();loc=AddCrumb(a);ShowBrowser(loc)})})}function Process_NewFolder(a,b){var a=$("input#folder").val();if(a!==""){var b=GetLocation();$.ajax({url:"includes/files.php?new="+escape(b+a+"/"),cache:false,success:function(c){if(c==1){CloseNewFolder();AddCrumb(a);ShowBrowser(b+a)}else{alert("Folder not created, please try again!")}}})}}function DeployApplication(b){var c=GetLocation();var d=$("#dir-"+b).text();var a=d+$("span#filename-"+b).text();$.post("includes/deploy.php",{appFile:a,extractLocation:c},function(e){if(e==1){alert("Application was successfully deployed.");CloseWindow("#filebrowser")}},"html")}function CloseNewFolder(){$("#folder-window").fadeOut("slow",function(){$("input#folder").val("")})}function AddCrumb(a){$("select#location").append($("<option></option>").attr("value",a+"/").text(a+"/"));var b="";$("select#location").children("option").each(function(){$(this).attr("selected","");b+=$(this).val()});$("select#location").children("option:last").attr("selected","selected");return b}function GetLocation(){var a="";$("select#location").children("option").each(function(){a+=$(this).val()});return a}function OpenWindow(a){$(a).fadeIn("slow")}function CloseWindow(a){$(a).fadeOut("slow")};